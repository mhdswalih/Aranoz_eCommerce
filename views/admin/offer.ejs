<%- include('../layout/adminheder') %>
<style>
     .dark-modal {
    background-color: #000000; /* Set background to black */
    color: #ffffff;
    border: 1px solid #444444;
  }

  .modal {
    z-index: 1050 !important;
  }

  .modal-backdrop {
    z-index: 1040 !important;
    background-color: rgba(0, 0, 0, 0.7); /* Dark semi-transparent backdrop */
  }

  .dark-modal .modal-header {
    border-bottom: 1px solid #444444;
  }

  .dark-modal .modal-footer {
    border-top: 1px solid #444444;
  }

  .dark-modal .form-control {
    background-color: #333333; /* Slightly lighter black for inputs */
    color: #ffffff;
    border: 1px solid #555555;
  }

  .dark-modal .btn-primary {
    background-color: #1a73e8;
    border-color: #1a73e8;
  }

  .dark-modal .close {
    color: #ffffff;
  }
</style>

<div class="container-fluid page-body-wrapper">
    <nav class="navbar p-0 fixed-top d-flex flex-row">
      <div
        class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center"
      >
        <a class="navbar-brand brand-logo-mini" href="/admin/home"
          ><img src="/Admin assets/assets/images/logo-mini.svg" alt="logo"
        /></a>
      </div>
      <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
        <button
          class="navbar-toggler navbar-toggler align-self-center"
          type="button"
          data-toggle="minimize"
        >
          <span class="mdi mdi-menu"></span>
        </button>
        <ul class="navbar-nav w-100">
          <li class="nav-item w-100">
            <form
              class="nav-link mt-2 mt-md-0 d-none d-lg-flex search"
              action=""
              method="get"
            >
              <input
                name="search"
                type="text"
                class="form-control"
                placeholder="Search Copon"
              />
              <button type="submit" class="search-btn">Search</button>
            </form>
          </li>
        </ul>
        <ul class="navbar-nav navbar-nav-right">
          <li class="nav-item dropdown d-none d-lg-block">
            <a
              class="nav-link btn btn-success create-new-button"
              id="createbuttonDropdown"
              data-toggle="modal"
              data-target="#addOfferModal"
              href=""
              >+ Add New Offer</a
            >
          </li>
        </ul>
      </div>
    </nav>

<div class="main-panel">
    <div class="content-wrapper">
      <div class="col-lg-12 grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <h4 class="card-title">OFFER Table</h4>
            <div class="table-responsive">
              <table class="table table-dark">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Offer Name</th>
                    <th>Discount Percentage</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Category</th>
                    <th>Brand</th>
                    <th>Items</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                
                      <tr>
                        <td></td>
                        <td></td>
                        <td>%</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>
                          <div class="btn-group">
                            <button
                              type="button"
                              class="btn btn-outline-secondary dropdown-toggle"
                              data-toggle="dropdown"
                            >
                              ...
                            </button>
                            <div class="dropdown-menu">
                              <button
                                type="button"
                            
                                class="btn btn-info btn-fw btn dropdown-item dlt-btn"
                              >
                                Delete
                              </button>
                              <a
                                type="button"
                                href="/admi"
                                class="btn btn-success btn-fw btn dropdown-item"
                                data-toggle="modal"
                                data-target="#editCouponModal"
                                
                              >
                                Edit
                              </a>
                            </div>
                          </div>
                        </td>
                      </tr>
                 
                    <tr>
                      <td colspan="9" class="text-center">No Coupons found</td>
                    </tr>
                
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<!-- Modal -->
<!-- Modal -->
<!-- Modal -->
<div
  class="modal fade"
  id="addOfferModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="addOfferLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" role="document">
    <div
      class="modal-content dark-modal"
      style="background-color: #191c24; border: none"
    >
      <div class="modal-header">
        <h5 class="modal-title" id="addOfferLabel">Add New Offer</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="background-color: #191c24">
        <form id="addOfferForm" action="/your-add-offer-endpoint" method="POST">
          <div class="form-group">
            <label for="offerName">Offer Name</label>
            <input
              type="text"
              name="offerName"
              class="form-control"
              id="offerName"
              placeholder="Enter offer name"
              required
            />
          </div>
          <div class="form-group">
            <label for="discountPercentage">Discount (%)</label>
            <input
              type="number"
              name="discountPercentage"
              class="form-control"
              id="discountPercentage"
              placeholder="Enter discount percentage"
              min="0"
              max="100"
              required
            />
          </div>
          <div class="form-group">
            <label for="startDate">Start Date</label>
            <input
              type="date"
              name="startDate"
              class="form-control"
              id="startDate"
              required
            />
          </div>
          <div class="form-group">
            <label for="endDate">End Date</label>
            <input
              type="date"
              name="endDate"
              class="form-control"
              id="endDate"
              required
            />
          </div>
          <div class="form-group">
            <label for="category">Category</label>
            <select
              class="form-control"
              id="category"
              name="category"
              required
            >
              <option value="" disabled selected>Select a category</option>
              <% categories.forEach(category => { %>
                <option value="<%= category._id %>"><%= category.name %></option>
              <% }); %>
            </select>
          </div>
          <div class="form-group">
            <label for="brand">Brand</label>
            <select class="form-control" id="brand" name="brand" required>
              <option value="" disabled selected>Select a brand</option>
              <% brands.forEach(brand => { %>
                <option value="<%= brand._id %>"><%= brand.name %></option>
              <% }); %>
            </select>
          </div>
          <div class="form-group">
            <label for="items">Items</label>
            <select class="form-control" id="items" name="items" multiple required>
                <option value="" disabled selected>Select items</option>
                <% products.forEach(product => { %>
                  <option value="<%= product._id %>"><%= product.name %></option>
                <% }); %>
              </select>
          </div>
          <div id="err" style="color: red"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          Close
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          style="background-color: #00d25b"
        >
          Add Offer
        </button>
        </form>
      </div>
    </div>
  </div>
</div>



  <%- include('../layout/adminfooter') %>  

  <script>
    document.getElementById('addOfferForm').addEventListener('submit',async(event)=>{
        event.preventDefault();

        const offerName = document.getElementById('offerName').value.trim();
        const discountPercentage = document.getElementById('discountPercentage').value.trim();
        const startDate = document.getElementById('startDate').value.trim();
        const endDate = document.getElementById('endDate').value.trim();
        const category = document.getElementById('category').value.trim();
        const brand = document.getElementById('brand').value.trim();
        const items = document.getElementById('items').value.trim();
        const err = document.getElementById('err')


        const response = await fetch('/add-Offer',{
            method : 'POST',
            headers : {
                'Content-Type':'application/json'
            },
            body :JSON.stringify({
                offerName,
                discountPercentage,
                startDate,
                endDate,
                category,
                brand,
                items,
            })
        })
        if(response.ok){
            window.location.href ='/offer'         
        }else{
            const data = await response.json()
            err.innerHTML = data.messege
        }
       


    })
  </script>